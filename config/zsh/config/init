#!/usr/bin/env bash
if command -v mise &> /dev/null; then
  eval "$(mise activate zsh)"
fi

if command -v starship &> /dev/null; then
  eval "$(starship init zsh)"
fi

if command -v zoxide &> /dev/null; then
  eval "$(zoxide init zsh)"
fi

if command -v fzf &> /dev/null; then
    source <(fzf --zsh)
fi

_dotfiles_stamp="/tmp/.dotfiles-pull-$(id -u)"
if [[ ! -f "$_dotfiles_stamp" ]] || [[ -n $(find "$_dotfiles_stamp" -mmin +240 2>/dev/null) ]]; then
    touch "$_dotfiles_stamp"
    git -C ~/src/dotfiles pull --rebase --quiet &>/dev/null &!
fi
unset _dotfiles_stamp
