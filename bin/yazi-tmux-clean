#!/bin/bash
# Clean wrapper for yazi in tmux popup

# Redirect stderr to /dev/null for the first 200ms
{
    sleep 0.2
    kill -USR1 $$ 2>/dev/null
} &

# Trap to restore stderr
trap 'exec 2>&3' USR1

# Save and redirect stderr
exec 3>&2
exec 2>/dev/null

# Set environment and run yazi
export TERM=xterm-256color
export COLORTERM=truecolor

# Run yazi
yazi "$@"

# Restore stderr on exit
exec 2>&3