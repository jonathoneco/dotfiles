#!/usr/bin/env bash

# Create SSH tunnel to forward Docker socket
echo "Creating SSH tunnel to garden-bed..."
ssh -p 3212 -L /tmp/docker.sock:/var/run/docker.sock -N jonco@garden-bed.local &
SSH_PID=$!

# Wait for tunnel to establish
sleep 2

# Run lazydocker with the forwarded socket
DOCKER_HOST="unix:///tmp/docker.sock" lazydocker "$@"

# Clean up
kill $SSH_PID 2>/dev/null
rm -f /tmp/docker.sock