#!/bin/bash
# Wrapper for yazi in tmux popup using nested session

# Suppress stderr for the first 100ms to hide terminal response timeout
{
    # Redirect stderr to null for a brief moment
    exec 2>/dev/null
    
    # Start tmux session in background
    tmux new-session -d -s "yazi-$$" "yazi $*" \; set status off
    
    # Brief pause to let error pass
    sleep 0.1
    
    # Restore stderr and attach to session
    exec 2>&1
    exec tmux attach-session -t "yazi-$$"
}